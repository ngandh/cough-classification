<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dao Hoang Ngan</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
        integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <style>
        * {
            font-family: 'Cabin', sans-serif;
        }
    </style>
</head>

<body class="p-3 ">
    <header style=" " class='d-flex align-items-center border-bottom pb-3'>
        <img src="https://haitrieu.com/wp-content/uploads/2021/10/Logo-Hoc-Vien-Cong-Nghe-Buu-Chinh-Vien-Thong-PTITSimple.png"
            style="width: 80px" class='mx-3'>
        <div class="ml-5">
            <h4 class='mx-3 my-2' style="color:red">ĐỒ ÁN TỐT NGHIỆP</h4>
            <h4 class='mx-3 my-2' style="color:red; font-size: 20px">Giảng viên hướng dẫn: PGS.TS. Phạm Văn Cường</h4>
            <h4 class='mx-3 my-2' style="color:red; font-size: 20px">Sinh viên: Đào Hoàng Ngân</h4>
        </div>
    </header>
    <!-- content -->
    <div class="mt-5 text-center d-flex align-items-center justify-content-center">
        <img src='https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Coughing_icon.svg/1024px-Coughing_icon.svg.png' style='width: 50px; height: 50px;'/>
        <h3 class='text-center my-0 mx-3'>PHÂN LOẠI TIẾNG HO SỬ DỤNG HỌC SÂU ÍT MẪU</h3>
    </div>
<!--    <form action ="" method ="POST" id="task-form" enctype="multipart/form-data">-->
    <form id = "task-form" >
<!--    {% csrf_token %}-->

    <div class="p-3 d-flex mx-auto">
        <!-- main left -->

        <div class="border p-3" style="border-radius: 8px; overflow: auto; width: 80%;">
            <!-- first input -->
            <div class="mb-4">
                <h4>Truy vấn: </h4>
                <div class="d-flex align-items-center">
                    <label class="mx-3 my-0" id='label-input-file' for="input-file"><i
                            class="fas fa-cloud-upload-alt fa-2x"></i></label>
                    <input class="mx-3 d-none" id="input-file" type="file" accept='.mp3, .wav'
                        onchange="loadFile(event)" name = "query">

                    <div class="d-flex flex-row-reverse align-items-center">
                        <div class="d-flex align-items-center">
                            <small id='label-label' class="d-none"><b>Nhãn:</b></small>
                            <span class="badge badge-light bg-success mx-2 text-white" id='label-of-file'
                                style='font-size: 20px;'></span>
                            <!-- <span id='label-of-file' class="sr-only">unread messages</span> -->
                        </div>
                        <audio class='d-none mx-3' id="output" src="" controls style="height: 40px; width: 400px;" />
                    </div>
                </div>
            </div>
            <div class="border-bottom">
                <h4>Hỗ trợ: </h4>

                <div class="d-flex align-items-center mb-3">
                    <label class="label-input-file mx-3 my-0" for="input-file-1"><i
                            class="fas fa-cloud-upload-alt fa-2x"></i></label>
                    <input class="mx-3 d-none input-file" id="input-file-1" type="file" accept='.mp3, .wav'
                        onchange="loadFileSupport1(event)" name = "s1">

                    <div class="d-flex flex-row-reverse align-items-center">
                        <div class="d-flex align-items-center">
                            <small class="d-none label-label"><b>Nhãn:</b></small>
                            <span class="label-of-file badge badge-light bg-success mx-2 text-white"
                                style='font-size: 20px;'></span>
                            <!-- <span id='label-of-file' class="sr-only">unread messages</span> -->
                        </div>
                        <audio class='d-none mx-3 output' src="" controls style="height: 40px; width: 400px;" />
                    </div>
                </div>

                <div class="d-flex align-items-center mb-3">
                    <label class="label-input-file mx-3 my-0" for="input-file-2"><i
                            class="fas fa-cloud-upload-alt fa-2x"></i></label>
                    <input class="mx-3 d-none input-file" id="input-file-2" type="file" accept='.mp3, .wav'
                        onchange="loadFileSupport2(event)" name = "s2">

                    <div class="d-flex flex-row-reverse align-items-center">
                        <div class="d-flex align-items-center">
                            <small class="d-none label-label"><b>Nhãn:</b></small>
                            <span class="label-of-file badge badge-light bg-success mx-2 text-white"
                                style='font-size: 20px;'></span>
                            <!-- <span id='label-of-file' class="sr-only">unread messages</span> -->
                        </div>
                        <audio class='d-none mx-3 output' src="" controls style="height: 40px; width: 400px;" />
                    </div>
                </div>

                <div class="d-flex align-items-center mb-3">
                    <label class="label-input-file mx-3 my-0" for="input-file-3"><i
                            class="fas fa-cloud-upload-alt fa-2x"></i></label>
                    <input class="mx-3 d-none input-file" id="input-file-3" type="file" accept='.mp3, .wav'
                        onchange="loadFileSupport3(event)" name = "s3">

                    <div class="d-flex flex-row-reverse align-items-center">
                        <div class="d-flex align-items-center">
                            <small class="d-none label-label"><b>Nhãn:</b></small>
                            <span class="label-of-file badge badge-light bg-success mx-2 text-white"
                                style='font-size: 20px;'></span>
                            <!-- <span id='label-of-file' class="sr-only">unread messages</span> -->
                        </div>
                        <audio class='d-none mx-3 output' src="" controls style="height: 40px; width: 400px;" />
                    </div>
                </div>

                <div class="d-flex align-items-center mb-3">
                    <label class="label-input-file mx-3 my-0" for="input-file-4"><i
                            class="fas fa-cloud-upload-alt fa-2x"></i></label>
                    <input class="mx-3 d-none input-file" id="input-file-4" type="file" accept='.mp3, .wav'
                        onchange="loadFileSupport4(event)" name = "s4">

                    <div class="d-flex flex-row-reverse align-items-center">
                        <div class="d-flex align-items-center">
                            <small class="d-none label-label"><b>Nhãn:</b></small>
                            <span class="label-of-file badge badge-light bg-success mx-2 text-white"
                                style='font-size: 20px;'></span>
                            <!-- <span id='label-of-file' class="sr-only">unread messages</span> -->
                        </div>
                        <audio class='d-none mx-3 output' src="" controls style="height: 40px; width: 400px;" />
                    </div>
                </div>

            </div>



<!--            <button class='btn btn-success float-right mt-3' onclick="getResult()"><b>Xem kết quả</b></button>-->
                <button class='btn btn-success float-right mt-3' type="submit" ><b>Xem kết quả</b></button>
        </div>

        <!-- main right -->
        <div class="col">
            <div class="border mx-3 p-3" style="border-radius: 8px;">
                <h4 class=" border-bottom pb-2">Dự đoán: </h4>
<!--                <div class="d-none border text-white col text-center bg-warning py-1 mt-3"-->
<!--                    style="border-radius: 8px; min-width: 50%; font-size: 20px;">-->
<!--                    {{predict}}-->
<!--                </div>-->
                <div id='result' class="d-none border text-white col text-center bg-warning py-1 mt-3"
                    style="border-radius: 8px; min-width: 50%; font-size: 20px;">
                    {{predict}}
<!--                    whoopingcough-->
                </div>
            </div>
        </div>
    </div>

    </form>
</body>
<script>
    var loadFile = function (event) {
        var reader = new FileReader();
        reader.onload = function () {
            var output = document.getElementById('output');
            let label = document.getElementById('label-input-file');
            output.classList.remove('d-none');
            output.src = reader.result;
            label.innerText = document.getElementById('input-file').files[0].name
            document.getElementById('label-of-file').innerText = document.getElementById('input-file').files[0].name.split('.')[0].split('_')[0]
            document.getElementById('label-label').classList.remove('d-none')
        };
        reader.readAsDataURL(event.target.files[0]);
    };

    let loadFileSupport1 = (event) => {
        let reader = new FileReader();
        let output = document.querySelectorAll('.output')[0];
        let label = document.querySelectorAll('.label-input-file')[0];

        reader.onload = function () {
            output.src = reader.result;
            output.classList.remove('d-none');
            label.innerText = document.querySelectorAll('.input-file')[0].files[0].name
            document.querySelectorAll('.label-of-file')[0].innerText = document.querySelectorAll('.input-file')[0].files[0].name.split('.')[0].split('_')[0]
            document.querySelectorAll('.label-label')[0].classList.remove('d-none')
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    let loadFileSupport2 = (event) => {
        let reader = new FileReader();
        let output = document.querySelectorAll('.output')[1];
        let label = document.querySelectorAll('.label-input-file')[1];

        reader.onload = function () {
            output.src = reader.result;
            output.classList.remove('d-none');
            label.innerText = document.querySelectorAll('.input-file')[1].files[0].name
            document.querySelectorAll('.label-of-file')[1].innerText = document.querySelectorAll('.input-file')[1].files[0].name.split('.')[0].split('_')[0]
            document.querySelectorAll('.label-label')[1].classList.remove('d-none')
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    let loadFileSupport3 = (event) => {
        let reader = new FileReader();
        let output = document.querySelectorAll('.output')[2];
        let label = document.querySelectorAll('.label-input-file')[2];

        reader.onload = function () {
            output.src = reader.result;
            output.classList.remove('d-none');
            label.innerText = document.querySelectorAll('.input-file')[2].files[0].name
            document.querySelectorAll('.label-of-file')[2].innerText = document.querySelectorAll('.input-file')[2].files[0].name.split('.')[0].split('_')[0]
            document.querySelectorAll('.label-label')[2].classList.remove('d-none')
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    let loadFileSupport4 = (event) => {
        let reader = new FileReader();
        let output = document.querySelectorAll('.output')[3];
        let label = document.querySelectorAll('.label-input-file')[3];

        reader.onload = function () {
            output.src = reader.result;
            output.classList.remove('d-none');
            label.innerText = document.querySelectorAll('.input-file')[3].files[0].name
            document.querySelectorAll('.label-of-file')[3].innerText = document.querySelectorAll('.input-file')[3].files[0].name.split('.')[0].split('_')[0]
            document.querySelectorAll('.label-label')[3].classList.remove('d-none')
        };
        reader.readAsDataURL(event.target.files[0]);
    }

    const getResult = () =>{
<!--        e.preventDefault();-->
        document.querySelector('#result').classList.remove('d-none');
    }

</script>
</script>
<!--<script src="https://code.jquery.com/jquery-3.5.1.js"-->
<!--          integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="-->
<!--            crossorigin="anonymous">-->

<!--</script>-->
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

<!--<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"-->
<!--    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"-->
<!--    crossorigin="anonymous"></script>-->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2"
    crossorigin="anonymous"></script>
<script>

</script>


<script type="text/javascript">
console.log('ahi');
<!--$(document).on('submit','#task-form',function(e){-->
 $(document).ready(function () {
   console.log($)
    console.log(11111)
    $("#task-form").submit(function (e){
        document.querySelector('#result').classList.remove('d-none');
        e.preventDefault();
        let formData = new FormData(this);
        formData.append( 'action','uploadImages');
        $.each($("input[type=file]"), function(i, obj) {
            $.each(obj.files,function(j, file){
                console.log(obj.name, file)
                formData.append(obj.name, file);
            })
        });
        $.ajax({
            type:'POST',
            url:'{% url "cough" %}',
            data: formData,
            processData: false,
            contentType: false,
            success:function(data) {
            console.log(data)
                  $('#result').html(data.predict);
                    }
            })
            return false;
        });

});
</script>


</html>